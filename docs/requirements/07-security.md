# 8. セキュリティ考慮事項

## 8.1 脅威モデル

### 脅威 1: 不正アクセス
- **影響**: 機密情報の漏洩
- **対策**: Passkey 認証、トークンの有効期限、監査ログ

### 脅威 2: トークン漏洩
- **影響**: なりすましによる機密情報へのアクセス
- **対策**: トークンのハッシュ化、短い有効期限、即座の無効化機能

### 脅威 3: データベース侵害
- **影響**: 保存された機密情報の漏洩
- **対策**: 暗号化保存、マスターキーの分離管理

### 脅威 4: リプレイ攻撃
- **影響**: 過去の認証情報の再利用
- **対策**: チャレンジ・レスポンス認証 (WebAuthn)

### 脅威 5: ライブラリの脆弱性
- **影響**: アプリケーション全体のセキュリティ侵害
- **対策**: 定期的な依存ライブラリの更新、セキュリティ監査

## 8.2 セキュリティベストプラクティス
1. マスターキーは環境変数で管理、コードに含めない
2. すべてのエラーメッセージから機密情報を除外
3. ログには機密情報を記録しない
4. 定期的なセキュリティ監査の実施
5. 依存ライブラリの定期的な更新
